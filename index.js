const _0x5da7=['text/html','catch','includes','https://oooo.serv00.net/add-url','Answer','join','connect','--tls','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','error:\x20','axios','Not\x20Found\x0a','reduce','https://amd64.ssss.nyc.mn/v1','error','2096','log','\x20-p\x20','type','update','index.html','sha224','length','NEZHA_PORT','replace','data','writeFileSync','config.yaml','NEZHA_KEY','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','chmod\x20+x\x20npm','pipe','country','decode','Failed\x20to\x20resolve\x20','arch','digest','PORT','&fp=chrome&type=ws&host=','readUInt8','close','WSPATH','toString','text/plain','write','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','writeHead','url','2053','NEZHA_SERVER','DOMAIN','&type=A','npm','map','concat','createServer','Hello\x20world!','pop','false','crypto','substr','1234.abc.com','env','connection','vless://','finish','readUInt16BE','createHash','get','2087','Server','1.1.1.1','slice','createWriteStream','client_secret:\x20','Unknown','https://'];const _0x40f3=function(_0x5da7a8,_0x40f386){_0x5da7a8=_0x5da7a8-0x0;let _0x38b73d=_0x5da7[_0x5da7a8];return _0x38b73d;};const os=require('os');const http=require('http');const fs=require('fs');const axios=require(_0x40f3('0xa'));const net=require('net');const path=require('path');const crypto=require(_0x40f3('0x3b'));const {Buffer}=require('buffer');const {exec,execSync}=require('child_process');const {WebSocket,createWebSocketStream}=require('ws');const UUID=process['env']['UUID']||'5cd900fa-e346-4725-adef-a799e65b2c34';const NEZHA_SERVER=process['env'][_0x40f3('0x31')]||'';const NEZHA_PORT=process[_0x40f3('0x3e')][_0x40f3('0x17')]||'';const NEZHA_KEY=process[_0x40f3('0x3e')][_0x40f3('0x1c')]||'';const DOMAIN=process['env'][_0x40f3('0x32')]||_0x40f3('0x3d');const AUTO_ACCESS=process['env']['AUTO_ACCESS']||!![];const WSPATH=process['env'][_0x40f3('0x29')]||UUID[_0x40f3('0x48')](0x0,0x8);const SUB_PATH=process['env']['SUB_PATH']||'sub';const NAME=process[_0x40f3('0x3e')]['NAME']||'Hug';const PORT=process[_0x40f3('0x3e')][_0x40f3('0x25')]||0x1eb4;let ISP='';const GetISP=async()=>{try{const _0x372051=await axios[_0x40f3('0x44')]('https://speed.cloudflare.com/meta');const _0x50cc41=_0x372051['data'];ISP=(_0x50cc41[_0x40f3('0x20')]+'-'+_0x50cc41['asOrganization'])[_0x40f3('0x18')](/ /g,'_');}catch(_0x571519){ISP=_0x40f3('0x4b');}};GetISP();const httpServer=http[_0x40f3('0x37')]((_0x501b1d,_0x395249)=>{if(_0x501b1d['url']==='/'){const _0x1a69b4=path['join'](__dirname,_0x40f3('0x14'));fs['readFile'](_0x1a69b4,'utf8',(_0x233cc9,_0x4369b1)=>{if(_0x233cc9){_0x395249[_0x40f3('0x2e')](0xc8,{'Content-Type':_0x40f3('0x0')});_0x395249['end'](_0x40f3('0x38'));return;}_0x395249[_0x40f3('0x2e')](0xc8,{'Content-Type':_0x40f3('0x0')});_0x395249['end'](_0x4369b1);});return;}else if(_0x501b1d[_0x40f3('0x2f')]==='/'+SUB_PATH){const _0x4500fb=_0x40f3('0x40')+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x40f3('0x26')+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP;const _0x38f957='trojan://'+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP;const _0x18a5de=_0x4500fb+'\x0a'+_0x38f957;const _0x359c00=Buffer['from'](_0x18a5de)[_0x40f3('0x2a')]('base64');_0x395249[_0x40f3('0x2e')](0xc8,{'Content-Type':'text/plain'});_0x395249['end'](_0x359c00+'\x0a');}else{_0x395249['writeHead'](0x194,{'Content-Type':_0x40f3('0x2b')});_0x395249['end'](_0x40f3('0xb'));}});const wss=new WebSocket[(_0x40f3('0x46'))]({'server':httpServer});const uuid=UUID['replace'](/-/g,'');const DNS_SERVERS=['8.8.4.4',_0x40f3('0x47')];function resolveHost(_0x3ace41){return new Promise((_0x352c45,_0x2deab2)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x3ace41)){_0x352c45(_0x3ace41);return;}let _0x55c4f4=0x0;function _0x2ff30b(){if(_0x55c4f4>=DNS_SERVERS['length']){_0x2deab2(new Error(_0x40f3('0x22')+_0x3ace41+'\x20with\x20all\x20DNS\x20servers'));return;}const _0x48bb67=DNS_SERVERS[_0x55c4f4];_0x55c4f4++;const _0x986d6a='https://dns.google/resolve?name='+encodeURIComponent(_0x3ace41)+_0x40f3('0x33');axios[_0x40f3('0x44')](_0x986d6a,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})['then'](_0x5d975a=>{const _0x39f55d=_0x5d975a[_0x40f3('0x19')];if(_0x39f55d['Status']===0x0&&_0x39f55d[_0x40f3('0x4')]&&_0x39f55d[_0x40f3('0x4')][_0x40f3('0x16')]>0x0){const _0x383aad=_0x39f55d['Answer']['find'](_0x275f68=>_0x275f68[_0x40f3('0x12')]===0x1);if(_0x383aad){_0x352c45(_0x383aad[_0x40f3('0x19')]);return;}}_0x2ff30b();})['catch'](_0x20f330=>{_0x2ff30b();});}_0x2ff30b();});}function handleVlessConnection(_0xbd4826,_0x435960){const [_0x25c2fa]=_0x435960;const _0x1fcc53=_0x435960[_0x40f3('0x48')](0x1,0x11);if(!_0x1fcc53['every']((_0x34c9f5,_0x1a98e5)=>_0x34c9f5==parseInt(uuid['substr'](_0x1a98e5*0x2,0x2),0x10)))return![];let _0x1f5998=_0x435960[_0x40f3('0x48')](0x11,0x12)[_0x40f3('0x27')]()+0x13;const _0x5c9e77=_0x435960['slice'](_0x1f5998,_0x1f5998+=0x2)[_0x40f3('0x42')](0x0);const _0x23679d=_0x435960['slice'](_0x1f5998,_0x1f5998+=0x1)[_0x40f3('0x27')]();const _0x47e649=_0x23679d==0x1?_0x435960['slice'](_0x1f5998,_0x1f5998+=0x4)[_0x40f3('0x5')]('.'):_0x23679d==0x2?new TextDecoder()[_0x40f3('0x21')](_0x435960['slice'](_0x1f5998+0x1,_0x1f5998+=0x1+_0x435960[_0x40f3('0x48')](_0x1f5998,_0x1f5998+0x1)[_0x40f3('0x27')]())):_0x23679d==0x3?_0x435960['slice'](_0x1f5998,_0x1f5998+=0x10)[_0x40f3('0xc')]((_0x505d8f,_0x559f81,_0x3655fc,_0x27598d)=>_0x3655fc%0x2?_0x505d8f['concat'](_0x27598d['slice'](_0x3655fc-0x1,_0x3655fc+0x1)):_0x505d8f,[])[_0x40f3('0x35')](_0x5574d2=>_0x5574d2[_0x40f3('0x42')](0x0)[_0x40f3('0x2a')](0x10))['join'](':'):'';_0xbd4826['send'](new Uint8Array([_0x25c2fa,0x0]));const _0x159ac7=createWebSocketStream(_0xbd4826);resolveHost(_0x47e649)['then'](_0x3f971b=>{net['connect']({'host':_0x3f971b,'port':_0x5c9e77},function(){this[_0x40f3('0x2c')](_0x435960['slice'](_0x1f5998));_0x159ac7['on']('error',()=>{})['pipe'](this)['on'](_0x40f3('0xe'),()=>{})['pipe'](_0x159ac7);})['on'](_0x40f3('0xe'),()=>{});})['catch'](_0x258ebc=>{net[_0x40f3('0x6')]({'host':_0x47e649,'port':_0x5c9e77},function(){this['write'](_0x435960[_0x40f3('0x48')](_0x1f5998));_0x159ac7['on'](_0x40f3('0xe'),()=>{})['pipe'](this)['on']('error',()=>{})['pipe'](_0x159ac7);})['on'](_0x40f3('0xe'),()=>{});});return!![];}function handleTrojanConnection(_0x40660e,_0x2235bc){try{if(_0x2235bc['length']<0x3a)return![];const _0x38d22b=_0x2235bc['slice'](0x0,0x38)[_0x40f3('0x2a')]();const _0x4eb519=[UUID];let _0x2d184b=null;for(const _0x4baeab of _0x4eb519){const _0x53dd2e=crypto[_0x40f3('0x43')](_0x40f3('0x15'))[_0x40f3('0x13')](_0x4baeab)[_0x40f3('0x24')]('hex');if(_0x53dd2e===_0x38d22b){_0x2d184b=_0x4baeab;break;}}if(!_0x2d184b)return![];let _0x2a53a8=0x38;if(_0x2235bc[_0x2a53a8]===0xd&&_0x2235bc[_0x2a53a8+0x1]===0xa){_0x2a53a8+=0x2;}const _0x56d206=_0x2235bc[_0x2a53a8];if(_0x56d206!==0x1)return![];_0x2a53a8+=0x1;const _0x5cf7f5=_0x2235bc[_0x2a53a8];_0x2a53a8+=0x1;let _0xa751e7,_0x4da959;if(_0x5cf7f5===0x1){_0xa751e7=_0x2235bc[_0x40f3('0x48')](_0x2a53a8,_0x2a53a8+0x4)['join']('.');_0x2a53a8+=0x4;}else if(_0x5cf7f5===0x3){const _0x58c6d2=_0x2235bc[_0x2a53a8];_0x2a53a8+=0x1;_0xa751e7=_0x2235bc['slice'](_0x2a53a8,_0x2a53a8+_0x58c6d2)[_0x40f3('0x2a')]();_0x2a53a8+=_0x58c6d2;}else if(_0x5cf7f5===0x4){_0xa751e7=_0x2235bc[_0x40f3('0x48')](_0x2a53a8,_0x2a53a8+0x10)['reduce']((_0x2e6f88,_0x108178,_0x32e1bc,_0x44ee94)=>_0x32e1bc%0x2?_0x2e6f88[_0x40f3('0x36')](_0x44ee94[_0x40f3('0x48')](_0x32e1bc-0x1,_0x32e1bc+0x1)):_0x2e6f88,[])[_0x40f3('0x35')](_0x41c863=>_0x41c863['readUInt16BE'](0x0)[_0x40f3('0x2a')](0x10))['join'](':');_0x2a53a8+=0x10;}else{return![];}_0x4da959=_0x2235bc['readUInt16BE'](_0x2a53a8);_0x2a53a8+=0x2;if(_0x2a53a8<_0x2235bc['length']&&_0x2235bc[_0x2a53a8]===0xd&&_0x2235bc[_0x2a53a8+0x1]===0xa){_0x2a53a8+=0x2;}const _0x46930a=createWebSocketStream(_0x40660e);resolveHost(_0xa751e7)['then'](_0x457531=>{net[_0x40f3('0x6')]({'host':_0x457531,'port':_0x4da959},function(){if(_0x2a53a8<_0x2235bc['length']){this['write'](_0x2235bc['slice'](_0x2a53a8));}_0x46930a['on']('error',()=>{})[_0x40f3('0x1f')](this)['on'](_0x40f3('0xe'),()=>{})[_0x40f3('0x1f')](_0x46930a);})['on'](_0x40f3('0xe'),()=>{});})[_0x40f3('0x1')](_0x5b477c=>{net[_0x40f3('0x6')]({'host':_0xa751e7,'port':_0x4da959},function(){if(_0x2a53a8<_0x2235bc['length']){this[_0x40f3('0x2c')](_0x2235bc[_0x40f3('0x48')](_0x2a53a8));}_0x46930a['on']('error',()=>{})['pipe'](this)['on']('error',()=>{})[_0x40f3('0x1f')](_0x46930a);})['on'](_0x40f3('0xe'),()=>{});});return!![];}catch(_0x13eb15){return![];}}wss['on'](_0x40f3('0x3f'),(_0x539629,_0x5830dd)=>{const _0x1af5a6=_0x5830dd['url']||'';_0x539629['once']('message',_0xa9efe1=>{if(_0xa9efe1['length']>0x11&&_0xa9efe1[0x0]===0x0){const _0x3cdae8=_0xa9efe1[_0x40f3('0x48')](0x1,0x11);const _0x5340af=_0x3cdae8['every']((_0xd37eb9,_0x163f14)=>_0xd37eb9==parseInt(uuid[_0x40f3('0x3c')](_0x163f14*0x2,0x2),0x10));if(_0x5340af){if(!handleVlessConnection(_0x539629,_0xa9efe1)){_0x539629[_0x40f3('0x28')]();}return;}}if(!handleTrojanConnection(_0x539629,_0xa9efe1)){_0x539629[_0x40f3('0x28')]();}})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x29cda1=os[_0x40f3('0x23')]();if(_0x29cda1==='arm'||_0x29cda1==='arm64'||_0x29cda1==='aarch64'){if(!NEZHA_PORT){return'https://arm64.ssss.nyc.mn/v1';}else{return'https://arm64.ssss.nyc.mn/agent';}}else{if(!NEZHA_PORT){return _0x40f3('0xd');}else{return'https://amd64.ssss.nyc.mn/agent';}}};const downloadFile=async()=>{if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x917241=getDownloadUrl();const _0x41b82d=await axios({'method':_0x40f3('0x44'),'url':_0x917241,'responseType':'stream'});const _0x21563c=fs[_0x40f3('0x49')]('npm');_0x41b82d['data'][_0x40f3('0x1f')](_0x21563c);return new Promise((_0x3371cb,_0x2526df)=>{_0x21563c['on'](_0x40f3('0x41'),()=>{console[_0x40f3('0x10')]('npm\x20download\x20successfully');exec(_0x40f3('0x1e'),_0x333f0a=>{if(_0x333f0a)_0x2526df(_0x333f0a);_0x3371cb();});});_0x21563c['on'](_0x40f3('0xe'),_0x2526df);});}catch(_0x446076){throw _0x446076;}};const runnz=async()=>{try{const _0x4cfa30=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':'utf-8'});if(_0x4cfa30['trim']()!==''){console[_0x40f3('0x10')]('npm\x20is\x20already\x20running,\x20skip\x20running...');return;}}catch(_0x18ddd3){}await downloadFile();let _0x2fe1e0='';let _0x1917a2=['443','8443',_0x40f3('0xf'),_0x40f3('0x45'),'2083',_0x40f3('0x30')];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x2514b3=_0x1917a2['includes'](NEZHA_PORT)?_0x40f3('0x7'):'';_0x2fe1e0='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+_0x40f3('0x11')+NEZHA_KEY+'\x20'+_0x2514b3+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x145f4b=NEZHA_SERVER[_0x40f3('0x2')](':')?NEZHA_SERVER['split'](':')[_0x40f3('0x39')]():'';const _0x1f50f8=_0x1917a2[_0x40f3('0x2')](_0x145f4b)?'true':_0x40f3('0x3a');const _0x17fe1f=_0x40f3('0x4a')+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x40f3('0x8')+_0x1f50f8+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x40f3('0x1a')]('config.yaml',_0x17fe1f);}_0x2fe1e0=_0x40f3('0x2d');}else{console['log'](_0x40f3('0x1d'));return;}try{exec(_0x2fe1e0,{'shell':'/bin/bash'},_0x254b2e=>{if(_0x254b2e)console['error']('npm\x20running\x20error:',_0x254b2e);else console[_0x40f3('0x10')]('npm\x20is\x20running');});}catch(_0x4b61d3){console['error'](_0x40f3('0x9')+_0x4b61d3);}};async function addAccessTask(){if(!AUTO_ACCESS)return;if(!DOMAIN){return;}const _0x2142ac=_0x40f3('0x4c')+DOMAIN;try{const _0x3ab40a=await axios['post'](_0x40f3('0x3'),{'url':_0x2142ac},{'headers':{'Content-Type':'application/json'}});console[_0x40f3('0x10')]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x3c4836){}}const delFiles=()=>{fs['unlink'](_0x40f3('0x34'),()=>{});fs['unlink'](_0x40f3('0x1b'),()=>{});};httpServer['listen'](PORT,()=>{runnz();setTimeout(()=>{delFiles();},0x2bf20);addAccessTask();console[_0x40f3('0x10')]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
